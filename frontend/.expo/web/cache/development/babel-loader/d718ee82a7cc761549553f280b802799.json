{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport api from 'axios';\nimport Home from \"./pages/Home\";\nimport Detail from \"./pages/Detail\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Stack = createStackNavigator();\n\nfunction Routes() {\n  var _useState = useState({\n    access_token: \"\",\n    expires_in: 0,\n    scope: \"\",\n    token_type: \"bearer\",\n    userFirstName: \"\",\n    userId: null\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var getUser = function _callee() {\n    var jsonValue;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('@user'));\n\n          case 3:\n            jsonValue = _context.sent;\n            return _context.abrupt(\"return\", jsonValue != null ? JSON.parse(jsonValue) : null);\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  var saveUser = function _callee2(user) {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            setUser(user);\n            console.log(user);\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('@user', JSON.stringify(user)));\n\n          case 5:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  };\n\n  useEffect(function () {\n    try {\n      getUser().then(function (userData) {\n        console.log(userData);\n\n        if (!userData) {\n          api.request({\n            method: 'POST',\n            url: \"http://localhost:8080/oauth/token\",\n            auth: {\n              username: \"dscatalog\",\n              password: \"dscatalog123\"\n            },\n            headers: {\n              'content-type': 'application/x-www-form-urlencoded'\n            },\n            params: {\n              grant_type: \"password\",\n              username: user.username || \"maria@gmail.com\",\n              password: user.password || \"123456\"\n            }\n          }).then(function (res) {\n            if (res.status >= 200 && res.status < 300) {\n              saveUser(res.data).then(function () {\n                return console.log('done');\n              });\n            } else {}\n          }).catch(function (err) {\n            console.log(err);\n          });\n        }\n      });\n    } catch (e) {}\n  }, []);\n  return _jsx(NavigationContainer, {\n    children: _jsxs(Stack.Navigator, {\n      children: [_jsx(Stack.Screen, {\n        name: \"Home\",\n        component: Home,\n        options: {\n          headerShow: false\n        }\n      }), _jsx(Stack.Screen, {\n        name: \"Detail\",\n        component: Detail,\n        options: {}\n      })]\n    })\n  });\n}\n\nexport default Routes;","map":{"version":3,"names":["React","useEffect","useState","NavigationContainer","createStackNavigator","AsyncStorage","api","Home","Detail","Stack","Routes","access_token","expires_in","scope","token_type","userFirstName","userId","user","setUser","getUser","getItem","jsonValue","JSON","parse","saveUser","console","log","setItem","stringify","then","userData","request","method","url","auth","username","password","headers","params","grant_type","res","status","data","catch","err","e","headerShow"],"sources":["/home/bruno/dev/simple-projects/frontend/src/router.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { createStackNavigator} from '@react-navigation/stack';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport api from 'axios';\n\nimport Home from './pages/Home';\nimport Detail from './pages/Detail';\n\nconst Stack = createStackNavigator();\n\nfunction Routes(){\n\n    const [user, setUser] = useState({\n        access_token: \"\",\n        expires_in: 0,\n        scope: \"\",\n        token_type: \"bearer\",\n        userFirstName: \"\",\n        userId: null\n    });\n    \n    const getUser = async () => {\n        try {\n            const jsonValue = await AsyncStorage.getItem('@user')\n            return jsonValue != null ? JSON.parse(jsonValue) : null;\n        } catch(e) {\n        }\n    }\n\n    const saveUser = async (user) => {\n        try {\n            setUser(user);\n            console.log(user)\n            return await AsyncStorage.setItem('@user', JSON.stringify(user));\n        } catch(e) {\n            // save error\n        }\n    }\n    \n    useEffect(\n    ()=>{\n        try{\n            getUser().then((userData) => {\n                console.log(userData)\n                if (!userData) {\n                api.request({\n                    method:'POST',\n                    url: `http://localhost:8080/oauth/token`,\n                    auth: {\n                        username: \"dscatalog\", \n                        password: \"dscatalog123\" \n                    },\n                    headers: { 'content-type': 'application/x-www-form-urlencoded' },\n                    params: {\n                    grant_type: \"password\",\n                    username: user.username || \"maria@gmail.com\",\n                    password: user.password || \"123456\",\n                    }\n                }).then(res => {\n                    if (res.status >= 200 && res.status < 300) {\n                        saveUser(res.data).then(() => console.log('done'))\n                    } else {\n                        \n                    }\n                }).catch((err) => {\n                    console.log(err);\n                })\n                }\n            })\n        } catch (e) {\n    \n        }\n    }\n    ,[])\n\n    return (\n        <NavigationContainer>\n            <Stack.Navigator>\n                <Stack.Screen\n                name=\"Home\"\n                component={Home}\n                options={{ headerShow: false}}\n                />\n                <Stack.Screen\n                name=\"Detail\"\n                component={Detail}\n                options={{}}\n                />\n            </Stack.Navigator>\n        </NavigationContainer>\n    )\n}\n\nexport default Routes;"],"mappings":"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"},"metadata":{},"sourceType":"module"}